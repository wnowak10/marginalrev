---
title: 'Exploring the Marginal Revolution Dataset'
author: 'Will Nowak'
date: '1 Sept 2016'
output:
  html_document:
    number_sections: true
    toc: true
    fig_width: 7
    fig_height: 4.5
    theme: readable
    highlight: tango
---

# Introduction

This is my first stab at a Kaggle script. 


There are three parts to my script as follows:

* Housekeeping
* Exploratory Data Analysis
* Comparative plots
* Machine Learning (imputation with mice package and randomForest)

# Housekeeping

Load libraries:

```{r, message = FALSE}
# Load packages
library('ggplot2') # visualization
library('ggthemes') # visualization
library('scales') # visualization
library('dplyr') # data manipulation
library('mice') # imputation
library('randomForest') # classification algorithm
```

Read in data: 

```{r, message = FALSE}
system("ls ../input")
testing <- read.csv("../input/cleanedmrdata.csv", comment.char="#")
```


# Exploratory Data Analysis 

What is structure of data set? What does header look like?

```{r, message = FALSE}
# check data
str(testing)

# look at head of data
head(testing)
```

That format looks pretty terrible, so I'll annotate, a bit. We have data on blog posts. 
For each, we have an author, a title, a date of publication, a word and comment count
for the post, and then dummy variables indicating whether (1) or not
(0) the post was tagged with this category. 

## What about some descriptive stats?


### Word Count Histogram (vertical line indicates mean): 
```{r, message = FALSE, warning=FALSE}
meaWordCount=mean(testing$numberofWords,na.rm=T)
ggplot(testing, aes(testing$numberofWords)) +
  geom_density(alpha=.1)+
  geom_vline(xintercept = meaWordCount)+
  labs(title = "Distribution of Post Word Count")+
  xlab('Word count')+
  ylab('Density')+
  xlim(0, 1000)
```

The mean word count is `r  format(round(meaWordCount, 2), nsmall = 2)`, the median is `r  median(testing$numberofWords, na.rm=T)`
and the standard deviation is `r  format(round(sd(testing$numberofWords,na.rm=T),2),nsmall=2)`.


### Comment Count Histogram (vertical line indicates mean):
```{r, message = FALSE,warning=F}
meaCommentCount=mean(testing$numberComments,na.rm=T)
ggplot(testing, aes(testing$numberComments)) +
  geom_density(alpha=.1)+
  geom_vline(xintercept = meaCommentCount)+
  labs(title = "Distribution of Cost Comment Count")+
  xlab('Comment count')+
  ylab('Density')+
  xlim(0, 50)
```

Let's move on.

# Comparative Plots 

## Hypothesis 1: Are posts getting longer (or shorter) over time?
```{r, message = FALSE,warning=F}
ggplot(testing, aes(testing$time,testing$numberofWords,colour=testing$author))+
  geom_point()+
  xlab('Date')+
  ylab('Word Count')+
   coord_cartesian(ylim = c(0, 1000))+
  labs(title="Word Count over Time")
```

The graph doesn't seem to indicate so.

## Hypothesis 2: Do longer posts indicate more (or less) comments?
```{r, message = FALSE,warning=F}
ggplot(testing, aes(testing$numberofWords,testing$numberComments,colour=testing$author))+
  geom_point()+
  xlab('Word Count')+
  ylab('Comment Count')+
  xlim(0,1000)+
   coord_cartesian(ylim = c(0, 50))+
  labs(title="Word Count related to Comment Count?")
```

Again, the graph doesn't seem to indicate so.

## Hypothesis 3: Cowen contributes more often, but Tabbarok often has long posts. Does the data confirm?

```{r, message = FALSE,warning=F}
ggplot(testing, aes(testing$numberofWords,colour=testing$author,fill=testing$author)) +
  geom_density(alpha=.1)+
  geom_vline(xintercept = mean(testing$numberofWords,na.rm=T))+
  labs(title = "Distribution of post word count by author")+
  xlab('Word count')+
  xlim(0,1000)+
  ylab('Density')
```

From Jan. 1, 2010 until August 2016, Cowen has
authored `r  format(round(nrow(testing[testing$author=='Tyler Cowen',]), 0), nsmall = 0)` 
(**impressively prolific rate of ~ `r format(round(nrow(testing[testing$author=='Tyler Cowen',]) / (365* 5.5),2),nsmall =2)` posts per day!**)
, while A.T. has only written `r  nrow(testing[testing$author=='Alex Tabarrok',])` posts. 
